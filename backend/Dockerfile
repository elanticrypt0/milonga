FROM golang:1.23-alpine

WORKDIR /app

# Instalar herramientas necesarias
RUN apk add --no-cache git && \
    go install github.com/air-verse/air@latest

# Copiar archivos de configuraci칩n
COPY . .

# Inicializar m칩dulo si no existe go.mod
RUN if [ ! -f go.mod ]; then \
    go mod init milonga && \
    go mod tidy; \
    fi

# Exponer el puerto que usar치 tu aplicaci칩n
EXPOSE 8921

# Usar air para hot-reload
CMD ["air"]